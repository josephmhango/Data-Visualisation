<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="K.J. Mhango">
<meta name="dcterms.date" content="2025-09-06">

<title>Space, Geometry, and Coordinate Systems</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="geometry_files/libs/clipboard/clipboard.min.js"></script>
<script src="geometry_files/libs/quarto-html/quarto.js"></script>
<script src="geometry_files/libs/quarto-html/popper.min.js"></script>
<script src="geometry_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="geometry_files/libs/quarto-html/anchor.min.js"></script>
<link href="geometry_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="geometry_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="geometry_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="geometry_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="geometry_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<style>html{ scroll-behavior: smooth; }</style>
<link href="geometry_files/libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">

<script src="geometry_files/libs/pagedtable-1.1/js/pagedtable.js"></script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#welcome" id="toc-welcome" class="nav-link active" data-scroll-target="#welcome"><span class="header-section-number">1</span> Welcome</a></li>
  <li><a href="#geometry-the-building-blocks-of-graphics" id="toc-geometry-the-building-blocks-of-graphics" class="nav-link" data-scroll-target="#geometry-the-building-blocks-of-graphics"><span class="header-section-number">2</span> 1) Geometry: The Building Blocks of Graphics</a>
  <ul class="collapse">
  <li><a href="#points-0d" id="toc-points-0d" class="nav-link" data-scroll-target="#points-0d"><span class="header-section-number">2.1</span> 1.1 Points (0‑D)</a></li>
  <li><a href="#lines-1d" id="toc-lines-1d" class="nav-link" data-scroll-target="#lines-1d"><span class="header-section-number">2.2</span> 1.2 Lines (1‑D)</a></li>
  <li><a href="#areas-2d-and-3d-on-2d" id="toc-areas-2d-and-3d-on-2d" class="nav-link" data-scroll-target="#areas-2d-and-3d-on-2d"><span class="header-section-number">2.3</span> 1.3 Areas (2‑D and “3‑D on 2‑D”)</a></li>
  <li><a href="#paths" id="toc-paths" class="nav-link" data-scroll-target="#paths"><span class="header-section-number">2.4</span> 1.4 Paths</a></li>
  <li><a href="#tukeys-schematic-plot-boxplot-and-a-contour-analogue" id="toc-tukeys-schematic-plot-boxplot-and-a-contour-analogue" class="nav-link" data-scroll-target="#tukeys-schematic-plot-boxplot-and-a-contour-analogue"><span class="header-section-number">2.5</span> 1.5 Tukey’s Schematic Plot (Boxplot) and a Contour Analogue</a></li>
  <li><a href="#partitions-polygons-and-contours" id="toc-partitions-polygons-and-contours" class="nav-link" data-scroll-target="#partitions-polygons-and-contours"><span class="header-section-number">2.6</span> 1.6 Partitions: Polygons and Contours</a></li>
  <li><a href="#networksgraphs-nodes-edges" id="toc-networksgraphs-nodes-edges" class="nav-link" data-scroll-target="#networksgraphs-nodes-edges"><span class="header-section-number">2.7</span> 1.7 Networks/Graphs (nodes + edges)</a></li>
  <li><a href="#stacks-dodges-and-jitter-collision-modifiers" id="toc-stacks-dodges-and-jitter-collision-modifiers" class="nav-link" data-scroll-target="#stacks-dodges-and-jitter-collision-modifiers"><span class="header-section-number">2.8</span> 1.8 Stacks, Dodges, and Jitter (Collision Modifiers)</a></li>
  </ul></li>
  <li><a href="#coordinate-systems-and-transformations" id="toc-coordinate-systems-and-transformations" class="nav-link" data-scroll-target="#coordinate-systems-and-transformations"><span class="header-section-number">3</span> 2) Coordinate Systems and Transformations</a>
  <ul class="collapse">
  <li><a href="#isometries-translation-rotation-reflection-distancepreserving" id="toc-isometries-translation-rotation-reflection-distancepreserving" class="nav-link" data-scroll-target="#isometries-translation-rotation-reflection-distancepreserving"><span class="header-section-number">3.1</span> 2.1 Isometries: Translation, Rotation, Reflection (distance‑preserving)</a></li>
  <li><a href="#similarities-and-affine-transformations" id="toc-similarities-and-affine-transformations" class="nav-link" data-scroll-target="#similarities-and-affine-transformations"><span class="header-section-number">3.2</span> 2.2 Similarities and Affine Transformations</a></li>
  <li><a href="#projections-and-conformal-mappings-planar" id="toc-projections-and-conformal-mappings-planar" class="nav-link" data-scroll-target="#projections-and-conformal-mappings-planar"><span class="header-section-number">3.3</span> 2.3 Projections and Conformal Mappings (planar)</a></li>
  <li><a href="#polar-coordinates-circles-roses-and-spider-radar-plots" id="toc-polar-coordinates-circles-roses-and-spider-radar-plots" class="nav-link" data-scroll-target="#polar-coordinates-circles-roses-and-spider-radar-plots"><span class="header-section-number">3.4</span> 2.4 Polar Coordinates: Circles, Roses, and Spider (Radar) Plots</a></li>
  <li><a href="#projections-onto-the-plane-perspective" id="toc-projections-onto-the-plane-perspective" class="nav-link" data-scroll-target="#projections-onto-the-plane-perspective"><span class="header-section-number">3.5</span> 2.5 Projections onto the Plane &amp; Perspective</a></li>
  <li><a href="#triangular-barycentric-coordinates" id="toc-triangular-barycentric-coordinates" class="nav-link" data-scroll-target="#triangular-barycentric-coordinates"><span class="header-section-number">3.6</span> 2.6 Triangular (Barycentric) Coordinates</a></li>
  <li><a href="#map-projections-3d-coordinate-systems-practical-ggplot" id="toc-map-projections-3d-coordinate-systems-practical-ggplot" class="nav-link" data-scroll-target="#map-projections-3d-coordinate-systems-practical-ggplot"><span class="header-section-number">3.7</span> 2.7 Map Projections &amp; 3‑D Coordinate Systems (practical ggplot)</a></li>
  </ul></li>
  <li><a href="#putting-it-together-what-to-ask-of-any-graphic" id="toc-putting-it-together-what-to-ask-of-any-graphic" class="nav-link" data-scroll-target="#putting-it-together-what-to-ask-of-any-graphic"><span class="header-section-number">4</span> 3) Putting It Together — What to Ask of Any Graphic</a></li>
  <li><a href="#practice-boxes-try-this" id="toc-practice-boxes-try-this" class="nav-link" data-scroll-target="#practice-boxes-try-this"><span class="header-section-number">5</span> 4) Practice Boxes (Try This)</a>
  <ul class="collapse">
  <li><a href="#a.-points-vs-lines" id="toc-a.-points-vs-lines" class="nav-link" data-scroll-target="#a.-points-vs-lines"><span class="header-section-number">5.1</span> A. Points vs Lines</a></li>
  <li><a href="#b.-areas-as-uncertainty" id="toc-b.-areas-as-uncertainty" class="nav-link" data-scroll-target="#b.-areas-as-uncertainty"><span class="header-section-number">5.2</span> B. Areas as Uncertainty</a></li>
  <li><a href="#c.-paths-vs-lines" id="toc-c.-paths-vs-lines" class="nav-link" data-scroll-target="#c.-paths-vs-lines"><span class="header-section-number">5.3</span> C. Paths vs Lines</a></li>
  <li><a href="#d.-boxplot-vs-contours" id="toc-d.-boxplot-vs-contours" class="nav-link" data-scroll-target="#d.-boxplot-vs-contours"><span class="header-section-number">5.4</span> D. Boxplot vs Contours</a></li>
  <li><a href="#e.-partitions" id="toc-e.-partitions" class="nav-link" data-scroll-target="#e.-partitions"><span class="header-section-number">5.5</span> E. Partitions</a></li>
  <li><a href="#f.-isometries-affines" id="toc-f.-isometries-affines" class="nav-link" data-scroll-target="#f.-isometries-affines"><span class="header-section-number">5.6</span> F. Isometries &amp; Affines</a></li>
  <li><a href="#g.-polar-spider" id="toc-g.-polar-spider" class="nav-link" data-scroll-target="#g.-polar-spider"><span class="header-section-number">5.7</span> G. Polar &amp; Spider</a></li>
  <li><a href="#h.-ternary" id="toc-h.-ternary" class="nav-link" data-scroll-target="#h.-ternary"><span class="header-section-number">5.8</span> H. Ternary</a></li>
  <li><a href="#i.-maps-projections" id="toc-i.-maps-projections" class="nav-link" data-scroll-target="#i.-maps-projections"><span class="header-section-number">5.9</span> I. Maps &amp; Projections</a></li>
  </ul></li>
  <li><a href="#key-takeaways" id="toc-key-takeaways" class="nav-link" data-scroll-target="#key-takeaways"><span class="header-section-number">6</span> 5) Key Takeaways</a></li>
  <li><a href="#appendix-minimal-matrix-forms" id="toc-appendix-minimal-matrix-forms" class="nav-link" data-scroll-target="#appendix-minimal-matrix-forms"><span class="header-section-number">7</span> Appendix: Minimal Matrix Forms</a>
  <ul class="collapse">
  <li><a href="#session-setup-copy-once" id="toc-session-setup-copy-once" class="nav-link" data-scroll-target="#session-setup-copy-once"><span class="header-section-number">7.1</span> Session Setup (copy once)</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Space, Geometry, and Coordinate Systems</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>K.J. Mhango </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 6, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="welcome" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="welcome"><span class="header-section-number">1</span> Welcome</h2>
<p>These study notes explore the structural backbone of data graphics: <strong>geometry</strong> (the shapes we draw) and <strong>coordinate systems</strong> (the spaces we draw them in).</p>
<p>Geometry answers <em>what kind of object is this?</em> — point, line, area, path, partition, network.</p>
<p>Coordinates answer <em>where does it live?</em> — on a flat Cartesian plane, a circle (polar), a triangle (barycentric), or a globe (map projections).</p>
<p>Together, they control what the data <em>looks like</em> and, crucially, what your audience can <em>perceive and compare</em>.</p>
<p>This document picks out and explains pertinent aspects from Chapter 8 and 9 of the grammar of graphics, using ggplot to showcase the concepts. It should give you the foundational understanding that you need to engage with and assimilate charts with complex geometry. With practice, you will begin to create complex charts of your own.</p>
<blockquote class="blockquote">
<p>Reading aim: By the end, you should be able to name the geometry in any chart, describe its coordinate system, explain the transformation used (if any), and reproduce a minimal version in <strong>R/ggplot2</strong>.</p>
</blockquote>
<hr>
</section>
<section id="geometry-the-building-blocks-of-graphics" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="geometry-the-building-blocks-of-graphics"><span class="header-section-number">2</span> 1) Geometry: The Building Blocks of Graphics</h2>
<section id="points-0d" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="points-0d"><span class="header-section-number">2.1</span> 1.1 Points (0‑D)</h3>
<p><strong>Idea:</strong> A point represents an observation positioned by two (or more) variables. Points are the atoms of scatterplots.</p>
<p><strong>When to use:</strong> Comparing two continuous variables; detecting clustering, outliers, or functional relationships.</p>
<p><strong>Key aesthetics:</strong> <code>x</code>, <code>y</code>, optional <code>colour</code>, <code>shape</code>, <code>size</code>, <code>alpha</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Sepal.Width, <span class="at">colour =</span> Species)) <span class="sc">+</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Points: Iris Sepals"</span>, <span class="at">x =</span> <span class="st">"Sepal Length"</span>, <span class="at">y =</span> <span class="st">"Sepal Width"</span>) <span class="sc">+</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="geometry_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Jitter for overlap:</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Species, Sepal.Length, <span class="at">colour =</span> Species)) <span class="sc">+</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Jitter reduces overplotting"</span>) <span class="sc">+</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="geometry_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="lines-1d" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="lines-1d"><span class="header-section-number">2.2</span> 1.2 Lines (1‑D)</h3>
<p><strong>Idea:</strong> Lines connect ordered points — either by <em>x</em> order (time series) or by group path (trajectories).</p>
<p><strong>When to use:</strong> Time trends; cumulative processes; ordered sequences.</p>
<p><strong>Key aesthetics:</strong> <code>x</code>, <code>y</code>, optional <code>group</code>, <code>linetype</code>, <code>colour</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Economics time series (built-in dataset)</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>pp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(economics, <span class="fu">aes</span>(date, unemploy)) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>pp <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Line: US Unemployment (1967–2015)"</span>, <span class="at">y =</span> <span class="st">"Unemployed (thousands)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="geometry_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Multiple groups:</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rolling mean lines by mpg class</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(zoo)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>mpg_smooth <span class="ot">&lt;-</span> mpg <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(class) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(displ) <span class="sc">%&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cty_roll =</span> <span class="fu">rollmean</span>(cty, <span class="at">k =</span> <span class="dv">5</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">align =</span> <span class="st">"center"</span>))</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg_smooth, <span class="fu">aes</span>(displ, cty_roll, <span class="at">colour =</span> class)) <span class="sc">+</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Lines by group (smoothed)"</span>, <span class="at">x =</span> <span class="st">"Engine displacement"</span>, <span class="at">y =</span> <span class="st">"City MPG (5-pt mean)"</span>) <span class="sc">+</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="geometry_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="areas-2d-and-3d-on-2d" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="areas-2d-and-3d-on-2d"><span class="header-section-number">2.3</span> 1.3 Areas (2‑D and “3‑D on 2‑D”)</h3>
<p><strong>Idea:</strong> Areas are filled regions: bars, ribbons, density bands, or surfaces rendered as colour/contours. In static 2‑D graphics, “3‑D” is conveyed by mapping the 3rd variable (<em>z</em>) to <strong>fill</strong> or <strong>contours</strong>.</p>
<p><strong>When to use:</strong> Accumulation over a baseline; uncertainty bands; representing a surface z = f(x, y).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Area under a line (ribbon)</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">cumsum</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>)))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">alpha =</span> <span class="fl">0.35</span>) <span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Area: Accumulation under a curve"</span>) <span class="sc">+</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="geometry_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Surface as raster + contours (quasi‑3D):</strong><br>
In ggplot, a <em>raster</em> is essentially a grid of rectangular tiles, one per cell of your matrix/data grid, each filled with a colour representing the z‑value. Unlike drawing each tile as a full polygon, <code>geom_raster()</code> is optimised for speed: it maps each (x,y) to a pixel‑like rectangle.<br>
A <em>contour</em> is different: ggplot calculates lines of equal z‑value across the surface and then draws them as vector paths. So the raster encodes values by filled cells, while the contour encodes values by isolines.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># volcano is a built-in matrix of elevations</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> volcano</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>vdf <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(v, <span class="at">varnames =</span> <span class="fu">c</span>(<span class="st">"x"</span>,<span class="st">"y"</span>), <span class="at">value.name =</span> <span class="st">"z"</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vdf, <span class="fu">aes</span>(x, y, <span class="at">fill =</span> z)) <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>() <span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="fu">aes</span>(<span class="at">z =</span> z), <span class="at">colour =</span> <span class="st">"white"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Surface as area (fill) with contours"</span>, <span class="at">fill =</span> <span class="st">"Elevation"</span>) <span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="geometry_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Note: True 3‑D geometry (with perspective depth) is beyond base ggplot2; instead we encode the third dimension in colour, contours, or facets.</p>
</blockquote>
<hr>
</section>
<section id="paths" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="paths"><span class="header-section-number">2.4</span> 1.4 Paths</h3>
<p><strong>Idea:</strong> A path is a line where order matters but x is not necessarily increasing (e.g., trajectories, cyclic movement).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lissajous-like path</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">t =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2</span><span class="sc">*</span>pi, <span class="at">length.out =</span> n)) <span class="sc">|&gt;</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x =</span> <span class="fu">sin</span>(<span class="dv">3</span><span class="sc">*</span>t), <span class="at">y =</span> <span class="fu">sin</span>(<span class="dv">4</span><span class="sc">*</span>t))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(path, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">linewidth =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Path geometry: ordered trajectory"</span>) <span class="sc">+</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="geometry_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="tukeys-schematic-plot-boxplot-and-a-contour-analogue" class="level3" data-number="2.5">
<h3 data-number="2.5" class="anchored" data-anchor-id="tukeys-schematic-plot-boxplot-and-a-contour-analogue"><span class="header-section-number">2.5</span> 1.5 Tukey’s Schematic Plot (Boxplot) and a Contour Analogue</h3>
<p><strong>Idea:</strong> Tukey’s boxplot is a <em>schema</em> geometry: a composite object encoding a distribution (median, quartiles, whiskers, outliers). A contour map is a schema for a surface — lines of equal value.</p>
<p><strong>Classical boxplot:</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Species, Sepal.Length, <span class="at">fill =</span> Species)) <span class="sc">+</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">outlier.alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Tukey's Schematic Plot (Boxplot)"</span>) <span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="geometry_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Contour as distribution schema (2‑D density):</strong><br>
Imagine a regular boxplot, which draws a simple rectangle around the middle 50% of a one-dimensional variable — it’s like placing a cardboard box over the densest part of the data. Now, picture that idea extended into two dimensions. Instead of a box, you get gently curving lines — like topographic rings — that trace around the densest clusters of data points. These are your contours. Each one wraps around a set percentage of the data, much like the boxplot fences do, but now smoothly flowing in all directions instead of slicing along fixed x and y axes. It’s like a heatmap with soft edges, where the heat lines follow the shape of the data cloud rather than forcing it into a square.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2-D density contours provide a schematic of a bivariate distribution</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Sepal.Width, <span class="at">colour =</span> Species)) <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density_2d</span>() <span class="sc">+</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Contour schema: lines of equal bivariate density"</span>) <span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="geometry_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>How they “check out”: the boxplot summarises 1‑D distribution via quantiles; density contours summarise 2‑D distribution via level sets. Both are compact, assumption‑light summaries.</p>
</blockquote>
<hr>
</section>
<section id="partitions-polygons-and-contours" class="level3" data-number="2.6">
<h3 data-number="2.6" class="anchored" data-anchor-id="partitions-polygons-and-contours"><span class="header-section-number">2.6</span> 1.6 Partitions: Polygons and Contours</h3>
<p><strong>Idea:</strong> Partitions divide space into meaningful regions.</p>
<ul>
<li><strong>Polygons</strong> tile an area (maps, Voronoi tessellations, choropleths).</li>
<li><strong>Contours</strong> partition a surface by equal value lines.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simple polygons: tiles on a grid</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>pg <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">y =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>pg<span class="sc">$</span>z <span class="ot">&lt;-</span> <span class="fu">with</span>(pg, (x <span class="sc">-</span> <span class="fl">5.5</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (y <span class="sc">-</span> <span class="fl">3.5</span>)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pg, <span class="fu">aes</span>(x, y, <span class="at">fill =</span> z)) <span class="sc">+</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">colour =</span> <span class="st">"grey90"</span>) <span class="sc">+</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Partition by polygons (tiles)"</span>, <span class="at">fill =</span> <span class="st">"Value"</span>) <span class="sc">+</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="geometry_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Contours revisited on a smooth function</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) <span class="fu">sin</span>(x) <span class="sc">*</span> <span class="fu">cos</span>(y)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="sc">-</span>pi, pi, <span class="at">length.out =</span> <span class="dv">200</span>),</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> <span class="fu">seq</span>(<span class="sc">-</span>pi, pi, <span class="at">length.out =</span> <span class="dv">200</span>))</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>xy<span class="sc">$</span>z <span class="ot">&lt;-</span> <span class="fu">with</span>(xy, <span class="fu">f</span>(x, y))</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(xy, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="fu">aes</span>(<span class="at">z =</span> z)) <span class="sc">+</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Partition by contours: level sets of z = sin(x)cos(y)"</span>) <span class="sc">+</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="geometry_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="networksgraphs-nodes-edges" class="level3" data-number="2.7">
<h3 data-number="2.7" class="anchored" data-anchor-id="networksgraphs-nodes-edges"><span class="header-section-number">2.7</span> 1.7 Networks/Graphs (nodes + edges)</h3>
<p><strong>Idea:</strong> Networks connect entities (nodes) by relations (edges). For example, imagine a data scientist has developed a model to optimise the London Underground schedule. To explain how traffic flows between stations in this model, they might visualise the underground as a network graph: each station is a node, each rail connection is an edge.</p>
<p>In <code>ggplot2</code>, we can sketch such transit networks using <code>geom_segment()</code> to draw the tracks (edges) and <code>geom_point()</code> to highlight the stations (nodes). The structure can even be laid out to mimic the general shape of the real Tube map using manually defined <code>x</code> and <code>y</code> positions for stations. This allows viewers to quickly grasp the overall flow, identify hubs, and see where congestion might build up.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Stylised metro-like network</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>stations <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"E"</span>, <span class="st">"F"</span>, <span class="st">"G"</span>, <span class="st">"H"</span>),</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>tracks <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">from =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"C"</span>, <span class="st">"B"</span>, <span class="st">"F"</span>, <span class="st">"G"</span>, <span class="st">"F"</span>, <span class="st">"H"</span>),</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">to   =</span> <span class="fu">c</span>(<span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"E"</span>, <span class="st">"E"</span>, <span class="st">"F"</span>, <span class="st">"E"</span>, <span class="st">"F"</span>, <span class="st">"H"</span>, <span class="st">"E"</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>tracks <span class="ot">&lt;-</span> tracks <span class="sc">|&gt;</span> </span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(stations, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"from"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">x =</span> x, <span class="at">y =</span> y) <span class="sc">|&gt;</span> </span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(stations, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"to"</span> <span class="ot">=</span> <span class="st">"id"</span>), <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">"_from"</span>,<span class="st">"_to"</span>))</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> tracks, <span class="fu">aes</span>(<span class="at">x =</span> x_from, <span class="at">y =</span> y_from, <span class="at">xend =</span> x_to, <span class="at">yend =</span> y_to),</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>               <span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">colour =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> stations, <span class="fu">aes</span>(x, y), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">colour =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> stations, <span class="fu">aes</span>(x, y, <span class="at">label =</span> id), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Stylised Metro Network (Nodes and Lines)"</span>) <span class="sc">+</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="geometry_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="stacks-dodges-and-jitter-collision-modifiers" class="level3" data-number="2.8">
<h3 data-number="2.8" class="anchored" data-anchor-id="stacks-dodges-and-jitter-collision-modifiers"><span class="header-section-number">2.8</span> 1.8 Stacks, Dodges, and Jitter (Collision Modifiers)</h3>
<p>The real estate available for plotting is always limited. Whether you’re preparing a dashboard, a research graphic, or a poster figure, the space in which data must be drawn is tiny compared to the size of the underlying dataset. This introduces a practical problem: <strong>collision</strong>.</p>
<p>A <strong>collision</strong> occurs when two or more data points occupy the same or nearly the same visual position in a plot, making it difficult or impossible to distinguish them. It can distort the reader’s perception — hiding overlaps, misrepresenting counts, or exaggerating the apparent smoothness or density of data.</p>
<p>To solve this, ggplot2 provides <strong>collision modifiers</strong> — visual strategies that reposition, separate, or spread out graphical elements while keeping the data intact:</p>
<ul>
<li><strong>Stack</strong>: piles elements vertically along a baseline. It’s useful for showing parts-of-a-whole (like bar charts), but makes comparison within stacks harder.</li>
<li><strong>Dodge</strong>: moves elements sideways into separate lanes. This is great for comparisons between groups but takes up more horizontal space.</li>
<li><strong>Jitter</strong>: adds small random nudges to scatterplot points, helping to reveal multiple overlapping observations (e.g.&nbsp;repeated test scores).</li>
</ul>
<p>Choosing the right modifier is a design decision: each comes with trade-offs in clarity, accuracy, and space efficiency.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Stack (parts of whole) and Dodge (side-by-side)</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(class, <span class="at">fill =</span> drv)) <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"stack"</span>) <span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Stacked counts by class and drive"</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="geometry_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(class, <span class="at">fill =</span> drv)) <span class="sc">+</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Dodged counts by class and drive"</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="geometry_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Jitter (with transparency)</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Species, Petal.Length, <span class="at">colour =</span> Species)) <span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.12</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Jittered points to reduce overlap"</span>) <span class="sc">+</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="geometry_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="coordinate-systems-and-transformations" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="coordinate-systems-and-transformations"><span class="header-section-number">3</span> 2) Coordinate Systems and Transformations</h2>
<p>In any graphic, coordinates define the space in which your data lives — and understanding that space is essential for drawing, interpreting, and even cleaning up your plots. Coordinate systems aren’t just for mathematicians — they shape how we perceive distance, direction, size, angle, and position.</p>
<p>In practical terms: getting your coordinates right means your plots make sense. Getting them wrong — or not understanding how they’re transformed — can make your visualisation misleading or unreadable.</p>
<p>Consider a situation where a field dataset is recorded using different units or orientations (e.g.&nbsp;rotated drone images, mirrored sensors). If you understand <strong>isometries</strong> like rotation, reflection, and translation, you can adjust or correct your data at the <em>data stage</em>, so that your visualisation requires less fiddling. Likewise, if your data needs to be rotated 90°, would you rather manually adjust your axis labels in ggplot — or just apply a matrix transform to your dataset once?</p>
<p>Similarly, knowing the difference between an affine transformation and a projection helps you interpret what the plot is <em>really</em> saying. Did the distortion come from the data itself? Or was it introduced by the coordinate system?</p>
<p>For example, consider the Mercator projection — a popular map projection used in web mapping tools. It preserves local angles (conformal), which is helpful for navigation, but dramatically distorts area, especially near the poles. This means that Greenland may appear nearly as large as Africa, even though Africa is over 14 times larger in reality. Such distortions aren’t just technicalities — they influence how we perceive geopolitical or demographic weight.</p>
<p>As a data scientist or designer, your choice of coordinate system and projection carries weight: it can either clarify or mislead. Being judicious with projections isn’t just about technical accuracy — it’s about ethical and perceptual responsibility.</p>
<p>This section builds your fluency with transformations — so you can reason about visual space, interpret graphical distortions, and intervene early (in your pipeline) when the coordinate context isn’t clean.</p>
<section id="isometries-translation-rotation-reflection-distancepreserving" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="isometries-translation-rotation-reflection-distancepreserving"><span class="header-section-number">3.1</span> 2.1 Isometries: Translation, Rotation, Reflection (distance‑preserving)</h3>
<p><strong>Isometries</strong> preserve distances and shapes. They move objects without stretching.</p>
<ul>
<li><strong>Translation</strong>: shift everything by a constant.</li>
<li><strong>Rotation</strong>: turn around the origin by angle θ.</li>
<li><strong>Reflection</strong>: mirror across a line (e.g., swap x and y).</li>
</ul>
<blockquote class="blockquote">
<p>“Reflection and rotation exchange range and domain” — in practice, a 90° rotation swaps axes roles; reflecting across the line y = x is equivalent to exchanging x and y.</p>
</blockquote>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Start with points on a circle</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>th <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2</span><span class="sc">*</span>pi, <span class="at">length.out =</span> <span class="dv">200</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>base <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">cos</span>(th), <span class="at">y =</span> <span class="fu">sin</span>(th))</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Define transforms</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>rotate <span class="ot">&lt;-</span> <span class="cf">function</span>(df, theta){</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  R <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">cos</span>(theta), <span class="sc">-</span><span class="fu">sin</span>(theta), <span class="fu">sin</span>(theta), <span class="fu">cos</span>(theta)), <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(<span class="fu">as.matrix</span>(df) <span class="sc">%*%</span> R) <span class="sc">|&gt;</span> <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">"x"</span>,<span class="st">"y"</span>))</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>translate <span class="ot">&lt;-</span> <span class="cf">function</span>(df, dx, dy){ <span class="fu">transform</span>(df, <span class="at">x =</span> x <span class="sc">+</span> dx, <span class="at">y =</span> y <span class="sc">+</span> dy) }</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>reflect_xy <span class="ot">&lt;-</span> <span class="cf">function</span>(df){ df[, <span class="fu">c</span>(<span class="st">"y"</span>,<span class="st">"x"</span>)] <span class="sc">|&gt;</span> <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">"x"</span>,<span class="st">"y"</span>)) }</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>b_rot <span class="ot">&lt;-</span> <span class="fu">rotate</span>(base, pi<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>b_ref <span class="ot">&lt;-</span> <span class="fu">reflect_xy</span>(base)</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>b_trn <span class="ot">&lt;-</span> <span class="fu">translate</span>(base, <span class="fl">1.2</span>, <span class="fl">0.4</span>)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>base<span class="sc">$</span>which <span class="ot">&lt;-</span> <span class="st">"base"</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>b_rot<span class="sc">$</span>which <span class="ot">&lt;-</span> <span class="st">"rot90"</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>b_ref<span class="sc">$</span>which <span class="ot">&lt;-</span> <span class="st">"reflect y=x"</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>b_trn<span class="sc">$</span>which <span class="ot">&lt;-</span> <span class="st">"+(1.2,0.4)"</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(base, b_rot, b_ref, b_trn)</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(all, <span class="fu">aes</span>(x, y, <span class="at">colour =</span> which)) <span class="sc">+</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>() <span class="sc">+</span> <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Isometries: translation, rotation, reflection (distance preserved)"</span>) <span class="sc">+</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="geometry_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="similarities-and-affine-transformations" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="similarities-and-affine-transformations"><span class="header-section-number">3.2</span> 2.2 Similarities and Affine Transformations</h3>
<p><strong>Similarity</strong> transformations preserve shape but not size (uniform scaling).<br>
<strong>Affine</strong> transformations are the most general linear transforms + translation (include scaling, rotation, reflection, <strong>shear</strong>).</p>
<p><strong>Why care?</strong> Aspect ratio choices and shears can change the <em>apparent</em> relationship.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Affine shear example: y' = y + 0.6x</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.6</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="dv">2</span>, <span class="dv">2</span>)  <span class="co"># shear in y by x</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.matrix</span>(base[,<span class="fu">c</span>(<span class="st">"x"</span>,<span class="st">"y"</span>)]) <span class="sc">%*%</span> A) <span class="sc">|&gt;</span> <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">"x"</span>,<span class="st">"y"</span>))</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>S<span class="sc">$</span>which <span class="ot">&lt;-</span> <span class="st">"shear"</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(base, S) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">which =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(which), <span class="st">"base"</span>, which)) <span class="sc">|&gt;</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y, <span class="at">colour =</span> which)) <span class="sc">+</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>() <span class="sc">+</span> <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Affine shear distorts angles, not straightness"</span>) <span class="sc">+</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="geometry_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Affine maps keep straight lines straight and parallel lines parallel, but <strong>do not</strong> preserve angles or lengths. Similarities are affine maps that keep angles (but scale lengths).</p>
</blockquote>
<hr>
</section>
<section id="projections-and-conformal-mappings-planar" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="projections-and-conformal-mappings-planar"><span class="header-section-number">3.3</span> 2.3 Projections and Conformal Mappings (planar)</h3>
<p><strong>Projection</strong> maps a higher/larger space onto a plane. We use projections to flatten surfaces (e.g., Earth) or to view high‑dimensional data.</p>
<ul>
<li><strong>Orthographic projection</strong>: drop perpendiculars to the plane (distance distortions).</li>
<li><strong>Perspective projection</strong>: as if from a camera — farther objects shrink.</li>
<li><strong>Conformal mapping</strong>: preserves local angles (e.g., Mercator on the sphere).</li>
</ul>
<p><strong>Illustration (perspective feel via affine trick):</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>tri <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.5</span>, <span class="dv">0</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.866</span>, <span class="dv">0</span>))</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="fl">0.4</span>, <span class="dv">1</span>), <span class="dv">2</span>, <span class="dv">2</span>) <span class="co"># skew to suggest depth</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>tri2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.matrix</span>(tri[,<span class="fu">c</span>(<span class="st">"x"</span>,<span class="st">"y"</span>)]) <span class="sc">%*%</span> P); <span class="fu">names</span>(tri2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"x"</span>,<span class="st">"y"</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>tri<span class="sc">$</span>which <span class="ot">&lt;-</span> <span class="st">"planar"</span>; tri2<span class="sc">$</span>which <span class="ot">&lt;-</span> <span class="st">"projected"</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(tri, tri2) <span class="sc">|&gt;</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y, <span class="at">group =</span> which, <span class="at">fill =</span> which)) <span class="sc">+</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">"grey30"</span>) <span class="sc">+</span> <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Projection idea on the plane (toy affine 'perspective')"</span>) <span class="sc">+</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="geometry_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>True conformal maps require analytic functions; in data viz we usually call into map projection utilities rather than hand‑coding them.</p>
</blockquote>
<hr>
</section>
<section id="polar-coordinates-circles-roses-and-spider-radar-plots" class="level3" data-number="3.4">
<h3 data-number="3.4" class="anchored" data-anchor-id="polar-coordinates-circles-roses-and-spider-radar-plots"><span class="header-section-number">3.4</span> 2.4 Polar Coordinates: Circles, Roses, and Spider (Radar) Plots</h3>
<p>Polar coordinates often feel unintuitive at first, especially if you’re used to thinking in straight lines and grids. But they are more common in everyday data visualisation than most people realise.</p>
<p>In a polar coordinate system, a point is defined not by how far it runs along the x and y axes, but by how far it is from the origin (radius <em>r</em>) and in which direction (angle <em>θ</em>). This is powerful whenever you’re dealing with <strong>cyclical phenomena</strong> (e.g.&nbsp;time of day, compass directions, phases, cycles).</p>
<p><strong>Familiar examples include:</strong></p>
<ul>
<li><strong>Pie charts</strong>, where each slice represents a proportion of a whole</li>
<li><strong>Rose diagrams</strong> used in meteorology (wind direction &amp; frequency)</li>
<li><strong>Spider/radar plots</strong> for comparing multivariate performance (e.g.&nbsp;fitness metrics or skill levels)</li>
<li><strong>Radial trees and hierarchies</strong>, which save space when displaying many branches</li>
</ul>
<p>Because polar charts wrap around a circle, they make efficient use of space for comparing part-to-whole relationships or highlighting symmetry. But they can also distort perception — especially for area and angle — so they must be used with care. Understanding how they work is essential for interpreting common charts and avoiding misleading design choices. Polar coordinates re‑express points by radius <em>r</em> and angle <em>θ</em>.</p>
<p><strong>Pie/Rose chart:</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Category parts-of-whole in polar</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">fill =</span> class)) <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">coord_polar</span>(<span class="at">theta =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Class"</span>)) <span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Pie (rose) via coord_polar"</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="geometry_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Polar cluster tree (radial branches):</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Build a simple radial tree using angles</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>levels <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>branches <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>angle <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2</span><span class="sc">*</span>pi, <span class="at">length.out =</span> <span class="dv">7</span>)[<span class="sc">-</span><span class="dv">7</span>]</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (a <span class="cf">in</span> angle){</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># trunk</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  branches <span class="ot">&lt;-</span> <span class="fu">rbind</span>(branches, <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">xend =</span> <span class="fu">cos</span>(a), <span class="at">yend =</span> <span class="fu">sin</span>(a), <span class="at">lvl=</span><span class="dv">1</span>))</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># second level</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.3</span>, <span class="dv">0</span>, <span class="fl">0.3</span>)){</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    a2 <span class="ot">&lt;-</span> a <span class="sc">+</span> k</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    branches <span class="ot">&lt;-</span> <span class="fu">rbind</span>(branches,</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">cos</span>(a), <span class="at">y =</span> <span class="fu">sin</span>(a), <span class="at">xend =</span> <span class="fl">1.6</span><span class="sc">*</span><span class="fu">cos</span>(a2), <span class="at">yend =</span> <span class="fl">1.6</span><span class="sc">*</span><span class="fu">sin</span>(a2), <span class="at">lvl=</span><span class="dv">2</span>))</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(branches, <span class="fu">aes</span>(x, y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend, <span class="at">linewidth =</span> <span class="fu">factor</span>(lvl))) <span class="sc">+</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">lineend =</span> <span class="st">"round"</span>) <span class="sc">+</span> <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span> <span class="fu">scale_linewidth_discrete</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Polar cluster tree (radial branches)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="geometry_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Spider/Radar plot:</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a radar/spider from wide -&gt; long</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>rad <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">c</span>(<span class="st">"A"</span>,<span class="st">"B"</span>), <span class="at">speed =</span> <span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">5</span>), <span class="at">power =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">8</span>), <span class="at">agility =</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">7</span>), <span class="at">stamina =</span> <span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">6</span>))</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>rad_long <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(rad, <span class="sc">-</span>group, <span class="at">names_to =</span> <span class="st">"metric"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Put metrics around a circle</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>rad_long<span class="sc">$</span>metric <span class="ot">&lt;-</span> <span class="fu">factor</span>(rad_long<span class="sc">$</span>metric, <span class="at">levels =</span> <span class="fu">unique</span>(rad_long<span class="sc">$</span>metric))</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Close the polygons by repeating the first metric at the end</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>rad_closed <span class="ot">&lt;-</span> rad_long <span class="sc">|&gt;</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(group) <span class="sc">|&gt;</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(metric, <span class="at">.by_group =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">complete</span>(metric, <span class="at">fill =</span> <span class="fu">list</span>(<span class="at">value =</span> <span class="cn">NA</span>)) <span class="sc">|&gt;</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> zoo<span class="sc">::</span><span class="fu">na.locf</span>(value, <span class="at">na.rm =</span> <span class="cn">FALSE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">drop_na</span>() <span class="sc">|&gt;</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(rad_long <span class="sc">|&gt;</span> <span class="fu">group_by</span>(group) <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span>))</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Angular position</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>ang <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">metric =</span> <span class="fu">levels</span>(rad_long<span class="sc">$</span>metric), <span class="at">theta =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2</span><span class="sc">*</span>pi, <span class="at">length.out =</span> <span class="fu">length</span>(<span class="fu">levels</span>(rad_long<span class="sc">$</span>metric)) <span class="sc">+</span> <span class="dv">1</span>)[<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>rad_plot <span class="ot">&lt;-</span> rad_long <span class="sc">|&gt;</span> <span class="fu">left_join</span>(ang, <span class="at">by =</span> <span class="st">"metric"</span>)</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw in polar via coord_polar</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>p_spider <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rad_long, <span class="fu">aes</span>(metric, value, <span class="at">group =</span> group, <span class="at">colour =</span> group, <span class="at">fill =</span> group)) <span class="sc">+</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>() <span class="sc">+</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Spider/Radar in ggplot (coord_polar)"</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>p_spider</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="geometry_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="projections-onto-the-plane-perspective" class="level3" data-number="3.5">
<h3 data-number="3.5" class="anchored" data-anchor-id="projections-onto-the-plane-perspective"><span class="header-section-number">3.5</span> 2.5 Projections onto the Plane &amp; Perspective</h3>
<p><strong>Concept:</strong> When we want to represent a three-dimensional scene on a two-dimensional page or screen, we have to reduce dimensionality. This can be done by simply ignoring one axis (called an orthographic projection), or by simulating how things appear smaller as they move further away (known as perspective projection, where vanishing points come into play).</p>
<p>In static 2D plotting — like most ggplot graphics — we can’t create true 3D visuals. But we can <em>simulate</em> depth by using visual cues such as shrinking point sizes, fading opacity (alpha), or applying skewing transformations that suggest distance. These tricks mimic perspective and give the illusion of 3D depth without needing interactive or rotating graphics.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Point cloud with depth mapped to size/alpha (fake perspective)</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>xyz <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">500</span>), <span class="at">y =</span> <span class="fu">rnorm</span>(<span class="dv">500</span>), <span class="at">z =</span> <span class="fu">rnorm</span>(<span class="dv">500</span>))</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(xyz, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> scales<span class="sc">::</span><span class="fu">rescale</span>(<span class="sc">-</span>z), <span class="at">alpha =</span> scales<span class="sc">::</span><span class="fu">rescale</span>(<span class="sc">-</span>z))) <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_alpha</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.9</span>), <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Perspective feel via size/alpha depth cue"</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="geometry_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="triangular-barycentric-coordinates" class="level3" data-number="3.6">
<h3 data-number="3.6" class="anchored" data-anchor-id="triangular-barycentric-coordinates"><span class="header-section-number">3.6</span> 2.6 Triangular (Barycentric) Coordinates</h3>
<p>Barycentric or triangular coordinates are ideal when you want to visualise the relative contributions of three components that always sum to a fixed total — typically 1 (or 100%). These components are often proportions or percentages of a mixture, composition, or blend.</p>
<p>This kind of chart is especially useful in <strong>compositional data analysis</strong>, where we care more about the relative shares of components than their absolute quantities. Because all three parts must add up to the same total, standard Cartesian plots fail to represent them faithfully — but a triangle can!</p>
<p><strong>Common real-world examples include:</strong></p>
<ul>
<li><strong>Soil texture triangles</strong>: the classic case — sand, silt, and clay add to 100% and define soil class.</li>
<li><strong>Marketing mix analysis</strong>: budget split between online, print, and events.</li>
<li><strong>Dietary proportions</strong>: proportion of calories from carbs, fat, and protein.</li>
<li><strong>Voting preferences</strong>: proportion of support across three competing political parties.</li>
<li><strong>Material science</strong>: composition of alloys or chemical formulations.</li>
</ul>
<p>Ternary plots let you locate any composition within a triangle, where each vertex represents 100% of one component. Points near a vertex indicate dominance of that component. Points near an edge show a mix of two, and points in the centre are balanced blends.</p>
<blockquote class="blockquote">
<p>Implementation note: The <strong>ggtern</strong> package extends ggplot2 with full support for ternary plots. If unavailable, we can simulate barycentric mapping manually by converting A+B+C=1 compositions into 2D (x, y) triangle coordinates. <strong>Idea:</strong> For 3‑part compositions that sum to 1 (or 100%): <code>(A, B, C)</code>. Soil texture (sand, silt, clay) is a classic example.</p>
</blockquote>
<blockquote class="blockquote">
<p>Implementation note: The <strong>ggtern</strong> extension adds ternary coordinates to ggplot. If not available, you can still <em>demonstrate</em> barycentric logic by constraining A+B+C=1 and drawing a filled triangle with <code>geom_polygon</code>.</p>
</blockquote>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using ggtern (if installed)</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("ggtern")</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggtern)</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># comp &lt;- data.frame(A = runif(200), B = runif(200)) |&gt; mutate(C = pmax(0, 1 - A - B)) |&gt; filter(A+B+C &gt;= 0.999)</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ggtern(comp, aes(A, B, C)) + geom_point(alpha = 0.6) + theme_bw() + labs(title = "Barycentric (ternary) coordinates")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Fallback demo (no ggtern):</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>tri <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.5</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="fu">sqrt</span>(<span class="dv">3</span>)<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>comp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">A =</span> <span class="fu">runif</span>(<span class="dv">300</span>), <span class="at">B =</span> <span class="fu">runif</span>(<span class="dv">300</span>)) <span class="sc">|&gt;</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">C =</span> <span class="fu">pmax</span>(<span class="dv">0</span>, <span class="dv">1</span> <span class="sc">-</span> A <span class="sc">-</span> B)) <span class="sc">|&gt;</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(A <span class="sc">+</span> B <span class="sc">+</span> C <span class="sc">&gt;</span> <span class="fl">0.999</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert (A,B,C) to triangle (x,y)</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>ABC_to_xy <span class="ot">&lt;-</span> <span class="cf">function</span>(A, B, C){</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># vertices: A=(0,0), B=(1,0), C=(0.5, sqrt(3)/2)</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> A<span class="sc">*</span><span class="dv">0</span> <span class="sc">+</span> B<span class="sc">*</span><span class="dv">1</span> <span class="sc">+</span> C<span class="sc">*</span><span class="fl">0.5</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> A<span class="sc">*</span><span class="dv">0</span> <span class="sc">+</span> B<span class="sc">*</span><span class="dv">0</span> <span class="sc">+</span> C<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">3</span>)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(x, y)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">ABC_to_xy</span>(comp<span class="sc">$</span>A, comp<span class="sc">$</span>B, comp<span class="sc">$</span>C)</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data =</span> tri, <span class="fu">aes</span>(x, y), <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">colour =</span> <span class="st">"grey40"</span>) <span class="sc">+</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> xy, <span class="fu">aes</span>(x, y), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Barycentric demo without ggtern"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="geometry_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="map-projections-3d-coordinate-systems-practical-ggplot" class="level3" data-number="3.7">
<h3 data-number="3.7" class="anchored" data-anchor-id="map-projections-3d-coordinate-systems-practical-ggplot"><span class="header-section-number">3.7</span> 2.7 Map Projections &amp; 3‑D Coordinate Systems (practical ggplot)</h3>
<p>Map projections are a powerful — and sometimes dangerous — way of transforming the 3D globe onto a 2D surface. Because it’s mathematically impossible to preserve all geographic properties when flattening a sphere, projections involve trade-offs. Some preserve <strong>area</strong>, others preserve <strong>shape</strong>, <strong>distance</strong>, or <strong>direction</strong> — but never all four.</p>
<p>This matters because map projections can strongly influence how we perceive space, scale, and importance. For instance, the Mercator projection — widely used in online mapping — makes Greenland appear almost the same size as Africa, when in reality Africa is over 14 times larger. Such distortions can lead to unconscious biases about geopolitical size and relevance.</p>
<p>Different projections suit different purposes:</p>
<ul>
<li><strong>Mercator</strong> preserves angle and direction (great for navigation) but distorts area.</li>
<li><strong>Equal-area projections</strong> like Mollweide or Gall-Peters preserve relative sizes but stretch shapes.</li>
<li><strong>Azimuthal (polar) projections</strong> are centred on a pole — useful for visualising Arctic or Antarctic phenomena.</li>
</ul>
<p>Understanding projections helps you avoid misleading your audience — and helps you choose a layout that matches your data story.</p>
<p>Below are two simple examples: one using Mercator-like scaling and another using a fixed aspect ratio that reduces distortion. For polar data (e.g., sea ice extent or polar bird migration), an azimuthal projection would be more appropriate, and can be rendered using <code>sf</code> + CRS codes (e.g., EPSG:3031 for the South Pole).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(maps)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>world <span class="ot">&lt;-</span> <span class="fu">map_data</span>(<span class="st">"world"</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Mercator-like default (conformal near equator)</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>merc <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(world, <span class="fu">aes</span>(long, lat, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">fill =</span> <span class="st">"grey85"</span>, <span class="at">colour =</span> <span class="st">"white"</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_quickmap</span>() <span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"World map (quick map, Mercator-ish)"</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Pseudo equal-area look using aspect</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>aea <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(world, <span class="fu">aes</span>(long, lat, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">fill =</span> <span class="st">"grey85"</span>, <span class="at">colour =</span> <span class="st">"white"</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="fl">1.3</span>) <span class="sc">+</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"World map (fixed aspect)"</span>)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>merc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="geometry_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>aea</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="geometry_files/figure-html/unnamed-chunk-24-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>For serious geographic work, use <code>sf</code> + <code>coord_sf(crs = ...)</code> to explicitly set projections. Even visual choices have interpretive consequences — be deliberate. <strong>Map projections</strong> flatten the globe onto a plane; each projection preserves some properties and sacrifices others (area, angle, distance).</p>
</blockquote>
<p><strong>Quick world sketch with built‑ins:</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(maps)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>world <span class="ot">&lt;-</span> <span class="fu">map_data</span>(<span class="st">"world"</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Mercator-like default (conformal near equator)</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>merc <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(world, <span class="fu">aes</span>(long, lat, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">fill =</span> <span class="st">"grey85"</span>, <span class="at">colour =</span> <span class="st">"white"</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_quickmap</span>() <span class="sc">+</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"World map (quick map, Mercator-ish)"</span>)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Pseudo equal-area look using aspect</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>aea <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(world, <span class="fu">aes</span>(long, lat, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">fill =</span> <span class="st">"grey85"</span>, <span class="at">colour =</span> <span class="st">"white"</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="fl">1.3</span>) <span class="sc">+</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"World map (fixed aspect)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<blockquote class="blockquote">
<p>For rigorous projections and 3‑D coordinate systems (e.g., WGS84 ellipsoid, EPSG codes), use <strong>sf</strong> + <code>coord_sf(crs = ...)</code>. The pedagogical point: projection choice changes areas, shapes, and distances — <em>interpret with care</em>.</p>
</blockquote>
<hr>
</section>
</section>
<section id="putting-it-together-what-to-ask-of-any-graphic" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="putting-it-together-what-to-ask-of-any-graphic"><span class="header-section-number">4</span> 3) Putting It Together — What to Ask of Any Graphic</h2>
<ol type="1">
<li><strong>What is the geometry?</strong> (points/lines/areas/paths/partitions/networks)</li>
<li><strong>What coordinate system?</strong> (Cartesian/polar/ternary/map)</li>
<li><strong>Any transformation?</strong> (isometry, similarity, affine, projection)</li>
<li><strong>How are collisions handled?</strong> (stack, dodge, jitter)</li>
<li><strong>What comparisons are easy vs hard?</strong> (length vs angle vs area vs colour)</li>
</ol>
<hr>
</section>
<section id="practice-boxes-try-this" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="practice-boxes-try-this"><span class="header-section-number">5</span> 4) Practice Boxes (Try This)</h2>
<section id="a.-points-vs-lines" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="a.-points-vs-lines"><span class="header-section-number">5.1</span> A. Points vs Lines</h3>
<ul>
<li>Recreate the <code>economics</code> line, then sample 12 points per year and compare readability.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Original line plot</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>pp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(economics, <span class="fu">aes</span>(date, unemploy)) <span class="sc">+</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">colour =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"US Unemployment (Full Time Series)"</span>, <span class="at">y =</span> <span class="st">"Unemployed (thousands)"</span>) <span class="sc">+</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Sampled 12 points per year</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>eco_sample <span class="ot">&lt;-</span> economics <span class="sc">|&gt;</span> </span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">year</span>(date)) <span class="sc">|&gt;</span> </span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">|&gt;</span> </span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">12</span>) <span class="sc">|&gt;</span> </span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>pp_sample <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(eco_sample, <span class="fu">aes</span>(date, unemploy)) <span class="sc">+</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">colour =</span> <span class="st">"firebrick"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"US Unemployment (12 Random Points per Year)"</span>, <span class="at">y =</span> <span class="st">"Unemployed (thousands)"</span>) <span class="sc">+</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a><span class="co"># View side by side if using patchwork</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>pp <span class="sc">+</span> pp_sample</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="geometry_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Discuss when connecting points <em>misleads</em> (unordered categories).</li>
</ul>
</section>
<section id="b.-areas-as-uncertainty" class="level3" data-number="5.2">
<h3 data-number="5.2" class="anchored" data-anchor-id="b.-areas-as-uncertainty"><span class="header-section-number">5.2</span> B. Areas as Uncertainty</h3>
<ul>
<li>Simulate a mean line with <code>geom_ribbon</code> 95% CI. Explain why ribbons are better than error bars when values are dense.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="at">y =</span> <span class="fu">cumsum</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>)))</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>lower <span class="ot">&lt;-</span> df<span class="sc">$</span>y <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>upper <span class="ot">&lt;-</span> df<span class="sc">$</span>y <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Ribbon plot showing confidence interval</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper), <span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">colour =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Mean with 95% CI Ribbon"</span>, <span class="at">y =</span> <span class="st">"Value"</span>) <span class="sc">+</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="geometry_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="c.-paths-vs-lines" class="level3" data-number="5.3">
<h3 data-number="5.3" class="anchored" data-anchor-id="c.-paths-vs-lines"><span class="header-section-number">5.3</span> C. Paths vs Lines</h3>
<ul>
<li>Create a cyclical path (like above) and show how <code>geom_line()</code> with sorted x destroys the shape.</li>
</ul>
</section>
<section id="d.-boxplot-vs-contours" class="level3" data-number="5.4">
<h3 data-number="5.4" class="anchored" data-anchor-id="d.-boxplot-vs-contours"><span class="header-section-number">5.4</span> D. Boxplot vs Contours</h3>
<ul>
<li>For <code>iris</code>, draw per‑species boxplots <em>and</em> bivariate density contours of <code>(Sepal.Length, Sepal.Width)</code>. Ask: which questions does each answer?</li>
</ul>
</section>
<section id="e.-partitions" class="level3" data-number="5.5">
<h3 data-number="5.5" class="anchored" data-anchor-id="e.-partitions"><span class="header-section-number">5.5</span> E. Partitions</h3>
<ul>
<li>Build a heat‑tile grid and practice changing <code>coord_equal</code>, <code>coord_fixed</code>, and aspect ratios. Observe shape distortion.</li>
</ul>
</section>
<section id="f.-isometries-affines" class="level3" data-number="5.6">
<h3 data-number="5.6" class="anchored" data-anchor-id="f.-isometries-affines"><span class="header-section-number">5.6</span> F. Isometries &amp; Affines</h3>
<ul>
<li>Apply rotation/reflection to a simple point set. Apply a shear and discuss which properties changed.</li>
</ul>
</section>
<section id="g.-polar-spider" class="level3" data-number="5.7">
<h3 data-number="5.7" class="anchored" data-anchor-id="g.-polar-spider"><span class="header-section-number">5.7</span> G. Polar &amp; Spider</h3>
<ul>
<li>Make a spider plot for 4–6 variables for two groups. Explain why area comparisons are tricky in polar.</li>
</ul>
</section>
<section id="h.-ternary" class="level3" data-number="5.8">
<h3 data-number="5.8" class="anchored" data-anchor-id="h.-ternary"><span class="header-section-number">5.8</span> H. Ternary</h3>
<ul>
<li>Generate 200 (A,B,C) with A+B+C=1. Use either <code>ggtern</code> or the fallback conversion. Interpret a cluster near the A–B edge.</li>
</ul>
</section>
<section id="i.-maps-projections" class="level3" data-number="5.9">
<h3 data-number="5.9" class="anchored" data-anchor-id="i.-maps-projections"><span class="header-section-number">5.9</span> I. Maps &amp; Projections</h3>
<ul>
<li>Plot the world with <code>maps</code> then compare to an equal‑area projection (if using <code>sf</code>). Which countries “shrink” or “grow”? Why does that matter?</li>
</ul>
<hr>
</section>
</section>
<section id="key-takeaways" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="key-takeaways"><span class="header-section-number">6</span> 5) Key Takeaways</h2>
<ul>
<li><strong>Geometry</strong> is the <em>what</em>; <strong>coordinates</strong> are the <em>where</em>.</li>
<li><strong>Isometries</strong> move without distortion; <strong>affines</strong> can shear/scale; <strong>projections</strong> flatten curved spaces — each has perceptual consequences.</li>
<li>In 2‑D static graphics, “3‑D” is achieved by mapping the third variable to <strong>fill</strong>, <strong>contour</strong>, <strong>size/alpha</strong>, or <strong>facets</strong>.</li>
<li><strong>Collision modifiers</strong> (stack/dodge/jitter) are design decisions, not afterthoughts — they change counts and comparisons.</li>
</ul>
<hr>
</section>
<section id="appendix-minimal-matrix-forms" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="appendix-minimal-matrix-forms"><span class="header-section-number">7</span> Appendix: Minimal Matrix Forms</h2>
<ul>
<li>Rotation by θ: (R() =
<span class="math display">\[\begin{bmatrix}\cos\theta &amp; -\sin\theta\\ \sin\theta &amp; \cos\theta\end{bmatrix}\]</span>
)</li>
<li>Reflection across y=x: swap coordinates ((x,y)(y,x))</li>
<li>Shear (x fixed, y += kx): (A =
<span class="math display">\[\begin{bmatrix}1 &amp; k\\ 0 &amp; 1\end{bmatrix}\]</span>
)</li>
<li>Similarity (scale s then rotate): (sR())</li>
</ul>
<blockquote class="blockquote">
<p>Use these to transform <em>data</em> before plotting, or use ggplot’s <code>coord_*</code> to transform the <em>space</em>.</p>
</blockquote>
<hr>
<section id="session-setup-copy-once" class="level3" data-number="7.1">
<h3 data-number="7.1" class="anchored" data-anchor-id="session-setup-copy-once"><span class="header-section-number">7.1</span> Session Setup (copy once)</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Core packages</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(zoo)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(maps)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Optional: ggtern, sf if available</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<blockquote class="blockquote">
<p>All examples use built‑in datasets (iris, mpg, economics, volcano, maps) to keep labs self‑contained.</p>
</blockquote>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<script src="geometry_files/libs/quarto-html/zenscroll-min.js"></script>
</body></html>